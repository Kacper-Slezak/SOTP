# .github/workflows/ci.yml - Główny workflow CI (Lint, Test, Build)

name: CI - Project Integration

on:
  push:
    branches:
      - main
      - develop

jobs:
  # To zadanie będzie w przyszłości uruchamiać testy, linting itp.
  build_and_test:
    name: Build & Test
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Simulate build and tests
        run: echo "Building and testing in progress..."

  # To zadanie wysyła powiadomienie na Discord po udanym commicie do głównej gałęzi
  notify_on_push:
    name: Notify Commit on Discord
    runs-on: ubuntu-latest
    # Uruchom to zadanie dopiero po pomyślnym zakończeniu `build_and_test`
    needs: build_and_test
    if: success()
    # Wywołanie naszego reużywalnego workflow
    uses: ./.github/workflows/discord_notifier.yml
    with:
      status: success
      environment: Commit to Main
      commit_sha: ${{ github.sha }}
      actor: ${{ github.actor }}
    secrets:
      # Przekazanie sekretu z URL webhooka
      webhook_url: ${{ secrets.DISCORD_WEBHOOK_URL }}